// import "./home.css";
// import ShoppingBagIcon from "@mui/icons-material/ShoppingBag";
// import GroupAddIcon from "@mui/icons-material/GroupAdd";
// import StoreIcon from "@mui/icons-material/Store";
// import EqualizerIcon from "@mui/icons-material/Equalizer";
// export default function Home() {
//   return (
//     <div class="MuiBox-root css-aim41u">
//       <div class="MuiBox-root css-bq11r7">
//         <div class="MuiGrid-root MuiGrid-container MuiGrid-spacing-xs-3 css-1h77wgb">
//           <div class="MuiGrid-root MuiGrid-item MuiGrid-grid-xs-12 MuiGrid-grid-md-6 MuiGrid-grid-lg-3 css-17cu47x">
//             <div class="MuiBox-root css-rwss59">
//               <div class="MuiPaper-root MuiPaper-elevation MuiPaper-rounded MuiPaper-elevation1 MuiCard-root css-sa3w6d">
//                 <div class="MuiBox-root css-p6siio">
//                   <div class="MuiBox-root css-79or14">
//                     <span
//                       class="material-icons-round notranslate MuiIcon-root MuiIcon-fontSizeMedium css-wlr1hm"
//                       aria-hidden="true"
//                     >
//                       <ShoppingBagIcon />
//                     </span>
//                   </div>
//                   <div class="MuiBox-root css-8k5edi">
//                     <span class="MuiTypography-root MuiTypography-button css-1dcnter">
//                       Bookings
//                     </span>
//                     <h4 class="MuiTypography-root MuiTypography-h4 css-rtlgmj">
//                       281
//                     </h4>
//                   </div>
//                 </div>
//                 <hr class="MuiDivider-root MuiDivider-fullWidth css-2hb8f" />
//                 <div class="MuiBox-root css-bln954">
//                   <p class="MuiTypography-root MuiTypography-button css-1fhu5z7">
//                     <span class="MuiTypography-root MuiTypography-button css-141aiuc">
//                       +55%
//                     </span>
//                     &nbsp;than lask week
//                   </p>
//                 </div>
//               </div>
//             </div>
//           </div>
//           <div class="MuiGrid-root MuiGrid-item MuiGrid-grid-xs-12 MuiGrid-grid-md-6 MuiGrid-grid-lg-3 css-17cu47x">
//             <div class="MuiBox-root css-rwss59">
//               <div class="MuiPaper-root MuiPaper-elevation MuiPaper-rounded MuiPaper-elevation1 MuiCard-root css-sa3w6d">
//                 <div class="MuiBox-root css-p6siio">
//                   <div class="MuiBox-root css-1mc398b">
//                     <span
//                       class="material-icons-round notranslate MuiIcon-root MuiIcon-fontSizeMedium css-wlr1hm"
//                       aria-hidden="true"
//                     >
//                       <GroupAddIcon />
//                     </span>
//                   </div>
//                   <div class="MuiBox-root css-8k5edi">
//                     <span class="MuiTypography-root MuiTypography-button css-1dcnter">
//                       Today's Users
//                     </span>
//                     <h4 class="MuiTypography-root MuiTypography-h4 css-rtlgmj">
//                       2,300
//                     </h4>
//                   </div>
//                 </div>
//                 <hr class="MuiDivider-root MuiDivider-fullWidth css-2hb8f" />
//                 <div class="MuiBox-root css-bln954">
//                   <p class="MuiTypography-root MuiTypography-button css-1fhu5z7">
//                     <span class="MuiTypography-root MuiTypography-button css-141aiuc">
//                       +3%
//                     </span>
//                     &nbsp;than last month
//                   </p>
//                 </div>
//               </div>
//             </div>
//           </div>
//           <div class="MuiGrid-root MuiGrid-item MuiGrid-grid-xs-12 MuiGrid-grid-md-6 MuiGrid-grid-lg-3 css-17cu47x">
//             <div class="MuiBox-root css-rwss59">
//               <div class="MuiPaper-root MuiPaper-elevation MuiPaper-rounded MuiPaper-elevation1 MuiCard-root css-sa3w6d">
//                 <div class="MuiBox-root css-p6siio">
//                   <div class="MuiBox-root css-bkvx7i">
//                     <span
//                       class="material-icons-round notranslate MuiIcon-root MuiIcon-fontSizeMedium css-wlr1hm"
//                       aria-hidden="true"
//                     >
//                       <StoreIcon />
//                     </span>
//                   </div>
//                   <div class="MuiBox-root css-8k5edi">
//                     <span class="MuiTypography-root MuiTypography-button css-1dcnter">
//                       Revenue
//                     </span>
//                     <h4 class="MuiTypography-root MuiTypography-h4 css-rtlgmj">
//                       34k
//                     </h4>
//                   </div>
//                 </div>
//                 <hr class="MuiDivider-root MuiDivider-fullWidth css-2hb8f" />
//                 <div class="MuiBox-root css-bln954">
//                   <p class="MuiTypography-root MuiTypography-button css-1fhu5z7">
//                     <span class="MuiTypography-root MuiTypography-button css-141aiuc">
//                       +1%
//                     </span>
//                     &nbsp;than yesterday
//                   </p>
//                 </div>
//               </div>
//             </div>
//           </div>
//           <div class="MuiGrid-root MuiGrid-item MuiGrid-grid-xs-12 MuiGrid-grid-md-6 MuiGrid-grid-lg-3 css-17cu47x">
//             <div class="MuiBox-root css-rwss59">
//               <div class="MuiPaper-root MuiPaper-elevation MuiPaper-rounded MuiPaper-elevation1 MuiCard-root css-sa3w6d">
//                 <div class="MuiBox-root css-p6siio">
//                   <div class="MuiBox-root css-14r4mt">
//                     <span
//                       class="material-icons-round notranslate MuiIcon-root MuiIcon-fontSizeMedium css-wlr1hm"
//                       aria-hidden="true"
//                     >
//                       <EqualizerIcon />
//                     </span>
//                   </div>
//                   <div class="MuiBox-root css-8k5edi">
//                     <span class="MuiTypography-root MuiTypography-button css-1dcnter">
//                       Followers
//                     </span>
//                     <h4 class="MuiTypography-root MuiTypography-h4 css-rtlgmj">
//                       +91
//                     </h4>
//                   </div>
//                 </div>
//                 <hr class="MuiDivider-root MuiDivider-fullWidth css-2hb8f" />
//                 <div class="MuiBox-root css-bln954">
//                   <p class="MuiTypography-root MuiTypography-button css-1fhu5z7">
//                     <span class="MuiTypography-root MuiTypography-button css-141aiuc"></span>
//                     &nbsp;Just updated
//                   </p>
//                 </div>
//               </div>
//             </div>
//           </div>
//         </div>
//       </div>
//     </div>
//   );
// }
import React, { useEffect, useState } from "react";
import axios from "axios";

import { useNavigate } from "react-router-dom";
import "./home1.css";
import { styled } from "@mui/material/styles";
import Table from "@mui/material/Table";
import TableBody from "@mui/material/TableBody";
import TableCell, { tableCellClasses } from "@mui/material/TableCell";
import TableContainer from "@mui/material/TableContainer";
import TableHead from "@mui/material/TableHead";
import TableRow from "@mui/material/TableRow";
import Paper from "@mui/material/Paper";
import Box from "@mui/material/Box";
import Card from "@mui/material/Card";
import CardActions from "@mui/material/CardActions";
import CardContent from "@mui/material/CardContent";
import Button from "@mui/material/Button";
import Typography from "@mui/material/Typography";
import EditIcon from "@mui/icons-material/Edit";
import DeleteIcon from "@mui/icons-material/Delete";
import IconButton from "@mui/material/IconButton";
import Modal from "@mui/material/Modal";
import TextField from "@mui/material/TextField";

const FormData = require("form-data");
export default function Home() {
  // let navigate = useNavigate();
  // useEffect(() => {
  //   if (localStorage.getItem("token")) {
  //     navigate("/");
  //   } else {
  //     navigate("/login");
  //   }
  //   // eslint-disable-next-line
  // }, []);
  const [row, setrow] = useState([]);
  const [file, setFile] = useState("");
  const [open, setOpen] = React.useState(false);
  const [data, setData] = useState({ name: "", subject: "", class: "" });

  const handleOpen = (rows) => {
    setOpen(true);
    setData(rows);
  };
  const onChange = (e) => {
    setData({ ...data, [e.target.name]: e.target.value });
  };
  const handleClose = () => setOpen(false);
  const onChange1 = (e) => {
    setFile(e.target.files[0]);
  };
  const showdata = () => {
    axios
      .get("http://localhost:9045/api/excelData/getexcelData")
      .then((data) => {
        console.log(data.data.result);
        setrow(data.data.result);
        console.log(row);
      })
      .catch((err) => {
        console.log(err);
      });
  };

  const deleteData = async (id) => {
    try {
      console.log(id);
      const res = await axios.delete(
        "http://localhost:9045/api/excelData/deletedata/" + id
      );
      if (res.data.message === "data has been deleted successfully") {
        alert(res.data.message);
      }
    } catch (err) {
      console.error(err);
    }
  };

  const handlesubmit1 = (e) => {
    e.preventDefault();
    const formData = new FormData();
    formData.append("excel", file);
    axios
      .post("http://localhost:9045/api/excelData/postexcelData", formData)
      .then((response) => {
        console.log(response.formData);
      })
      .catch((error) => {
        console.log(error);
      });
  };

  const StyledTableCell = styled(TableCell)(({ theme }) => ({
    [`&.${tableCellClasses.head}`]: {
      backgroundColor: theme.palette.common.black,
      color: theme.palette.common.white,
    },
    [`&.${tableCellClasses.body}`]: {
      fontSize: 14,
    },
  }));
  const StyledTableRow = styled(TableRow)(({ theme }) => ({
    "&:nth-of-type(odd)": {
      backgroundColor: theme.palette.action.hover,
    },
    // hide last border
    "&:last-child td, &:last-child th": {
      border: 0,
    },
  }));

  return (
    <div>
      <Card sx={{ minWidth: 275 }}>
        <CardContent>
          <form onSubmit={handlesubmit1} enctype="multipart/form-data">
            <label for="excel">BrowseFile</label>
            <input type="file" class="form-control" name="excel" required />
            <br></br>
            <Button size="small" type="submit" value="submit">
              Submit
            </Button>{" "}
          </form>{" "}
        </CardContent>
        <CardActions>
          <Button size="small" onClick={showdata}>
            Show Data
          </Button>
        </CardActions>
      </Card>
      <Modal
        open={open}
        onClose={handleClose}
        aria-labelledby="modal-modal-title"
        aria-describedby="modal-modal-description"
      >
        <Box className="box11">
          <div className="css-15m7mkq1">
            <h4 class="MuiTypography-root MuiTypography-h4 css-1139jqi1">
              Update Data
            </h4>
          </div>
          <div className="form-div11">
            <form>
              <div className="form-div21">
                <Box sx={{ display: "flex", alignItems: "flex-end" }}>
                  <TextField
                    fullWidth
                    // id="input-with-sx"
                    label="Name"
                    variant="standard"
                    id="name"
                    name="name"
                    value={data.name}
                    onChange={onChange}
                  />
                </Box>
              </div>
              <div className="form-div21">
                <TextField
                  required
                  fullWidth
                  id="outlined-required"
                  label="class"
                  type="text"
                  variant="standard"
                  size="small"
                  name="class"
                  value={data.class}
                  onChange={onChange}
                />
              </div>
              <div className="form-div21">
                <TextField
                  fullWidth
                  required
                  label="subject"
                  type="text"
                  variant="standard"
                  size="small"
                  value={data.subject}
                  onChange={onChange}
                  name="subject"
                />
              </div>
              <div class="MuiBox-root css-1id64jh1">
                <button
                  class="MuiButton-root MuiButton-contained MuiButton-containedPrimary MuiButton-sizeMedium MuiButton-containedSizeMedium MuiButton-fullWidth MuiButtonBase-root css-oagsia"
                  tabindex="0"
                  type="submit"
                >
                  Update Data
                  {/* <span class="MuiTouchRipple-root css-w0pj6f"></span> */}
                </button>
              </div>
            </form>
          </div>
        </Box>
      </Modal>
      <TableContainer component={Paper}>
        <Table sx={{ minWidth: 700 }} aria-label="customized table">
          <TableHead>
            <TableRow>
              <StyledTableCell>Id's</StyledTableCell>
              <StyledTableCell>Name</StyledTableCell>
              <StyledTableCell>Class</StyledTableCell>
              <StyledTableCell>Subject</StyledTableCell>
              <StyledTableCell>Actions</StyledTableCell>
            </TableRow>
          </TableHead>
          <TableBody>
            {row.reverse().map((rows) => (
              <StyledTableRow key={row.id}>
                <StyledTableCell>{rows._id}</StyledTableCell>
                <StyledTableCell>{rows.name}</StyledTableCell>
                <StyledTableCell>{rows.class}</StyledTableCell>
                <StyledTableCell>{rows.subject}</StyledTableCell>
                <IconButton
                  aria-label="delete"
                  size="large"
                  onClick={() => handleOpen(rows)}
                >
                  <EditIcon />
                </IconButton>
                <IconButton
                  aria-label="delete"
                  size="large"
                  onClick={() => deleteData(rows._id)}
                >
                  <DeleteIcon />
                </IconButton>
              </StyledTableRow>
            ))}
          </TableBody>
        </Table>
      </TableContainer>
    </div>
  );
}
